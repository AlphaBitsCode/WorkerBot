/* Copyright (C) 2023 by WorkerBot.AI */
!function(t){function e(e){var a=t.data(e,"datebox"),o=a.options;if(t(e).addClass("datebox-f").combo(t.extend({},o,{onShowPanel:function(){!function(e){var a=t(e).datebox("options"),n=t(e).combo("panel");n._unbind(".datebox")._bind("click.datebox",(function(n){if(t(n.target).hasClass("datebox-button-a")){var o=parseInt(t(n.target).attr("datebox-button-index"));a.buttons[o].handler.call(n.target,e)}}))}(this),function(e){var a=t(e).combo("panel");if(a.children("div.datebox-button").length)return;for(var n=t('<div class="datebox-button"><table cellspacing="0" cellpadding="0" style="width:100%"><tr></tr></table></div>').appendTo(a).find("tr"),r=0;r<o.buttons.length;r++){var d=t("<td></td>").appendTo(n),i=o.buttons[r];t('<a class="datebox-button-a" href="javascript:;"></a>').html(t.isFunction(i.text)?i.text(e):i.text).appendTo(d).attr("datebox-button-index",r)}n.find("td").css("width",100/o.buttons.length+"%")}(this),function(e){var n=t(e).combo("panel"),r=n.children("div.datebox-calendar-inner");if(n.children()._outerWidth(n.width()),a.calendar.appendTo(r),a.calendar[0].target=e,"auto"!=o.panelHeight){var d=n.height();n.children().not(r).each((function(){d-=t(this).outerHeight()})),r._outerHeight(d)}a.calendar.calendar("resize")}(this),n(this,t(this).datebox("getText"),!0),o.onShowPanel.call(this)}})),!a.calendar){var r=t(e).combo("panel").css("overflow","hidden");r.panel("options").onBeforeDestroy=function(){var e=t(this).find(".calendar-shared");e.length&&e.insertBefore(e[0].pholder)};var d=t('<div class="datebox-calendar-inner"></div>').prependTo(r);if(o.sharedCalendar){var i=t(o.sharedCalendar);i[0].pholder||(i[0].pholder=t('<div class="calendar-pholder" style="display:none"></div>').insertAfter(i)),i.addClass("calendar-shared").appendTo(d),i.hasClass("calendar")||i.calendar(),a.calendar=i}else a.calendar=t("<div></div>").appendTo(d).calendar();t.extend(a.calendar.calendar("options"),{fit:!0,border:!1,onSelect:function(e){var a=this.target,o=t(a).datebox("options");o.onSelect.call(a,e),n(a,o.formatter.call(a,e)),t(a).combo("hidePanel")}})}t(e).combo("textbox").parent().addClass("datebox"),t(e).datebox("initValue",o.value)}function a(e){var a=t.data(e,"datebox"),o=a.options,r=a.calendar.calendar("options").current;r&&(n(e,o.formatter.call(e,r)),t(e).combo("hidePanel"))}function n(e,a,n){var o=t.data(e,"datebox"),r=o.options,d=o.calendar;d.calendar("moveTo",r.parser.call(e,a)),n?t(e).combo("setValue",a):(a&&(a=r.formatter.call(e,d.calendar("options").current)),t(e).combo("setText",a).combo("setValue",a))}t.fn.datebox=function(a,n){if("string"==typeof a){var o=t.fn.datebox.methods[a];return o?o(this,n):this.combo(a,n)}return a=a||{},this.each((function(){var n=t.data(this,"datebox");n?t.extend(n.options,a):t.data(this,"datebox",{options:t.extend({},t.fn.datebox.defaults,t.fn.datebox.parseOptions(this),a)}),e(this)}))},t.fn.datebox.methods={options:function(e){var a=e.combo("options");return t.extend(t.data(e[0],"datebox").options,{width:a.width,height:a.height,originalValue:a.originalValue,disabled:a.disabled,readonly:a.readonly})},cloneFrom:function(e,a){return e.each((function(){t(this).combo("cloneFrom",a),t.data(this,"datebox",{options:t.extend(!0,{},t(a).datebox("options")),calendar:t(a).datebox("calendar")}),t(this).addClass("datebox-f")}))},calendar:function(e){return t.data(e[0],"datebox").calendar},initValue:function(e,a){return e.each((function(){var e=t(this).datebox("options");if(a){var n=e.parser.call(this,a);a=e.formatter.call(this,n),t(this).datebox("calendar").calendar("moveTo",n)}t(this).combo("initValue",a).combo("setText",a)}))},setValue:function(t,e){return t.each((function(){n(this,e)}))},reset:function(e){return e.each((function(){var e=t(this).datebox("options");t(this).datebox("setValue",e.originalValue)}))},setDate:function(e,a){return e.each((function(){var e=t(this).datebox("options");t(this).datebox("calendar").calendar("moveTo",a),n(this,a?e.formatter.call(this,a):"")}))},getDate:function(t){return t.datebox("getValue")?t.datebox("calendar").calendar("options").current:null}},t.fn.datebox.parseOptions=function(e){return t.extend({},t.fn.combo.parseOptions(e),t.parser.parseOptions(e,["sharedCalendar"]))},t.fn.datebox.defaults=t.extend({},t.fn.combo.defaults,{panelWidth:250,panelHeight:"auto",sharedCalendar:null,keyHandler:{up:function(t){},down:function(t){},left:function(t){},right:function(t){},enter:function(t){a(this)},query:function(t,e){!function(t,e){n(t,e,!0)}(this,t)}},currentText:"Today",closeText:"Close",okText:"Ok",buttons:[{text:function(e){return t(e).datebox("options").currentText},handler:function(e){var n=t(e).datebox("options"),o=new Date,r=new Date(o.getFullYear(),o.getMonth(),o.getDate());t(e).datebox("calendar").calendar({year:r.getFullYear(),month:r.getMonth()+1,current:r}),n.onSelect.call(e,r),a(e)}},{text:function(e){return t(e).datebox("options").closeText},handler:function(e){t(this).closest("div.combo-panel").panel("close")}}],formatter:function(t){var e=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();return(a<10?"0"+a:a)+"/"+(n<10?"0"+n:n)+"/"+e},parser:function(e){var a=t.fn.calendar.defaults.Date;if(t(this).data("datebox")&&(a=t(this).datebox("calendar").calendar("options").Date),!e)return new a;var n=e.split("/"),o=parseInt(n[0],10),r=parseInt(n[1],10),d=parseInt(n[2],10);return isNaN(d)||isNaN(o)||isNaN(r)?new a:new a(d,o-1,r)},onSelect:function(t){}})}(jQuery);