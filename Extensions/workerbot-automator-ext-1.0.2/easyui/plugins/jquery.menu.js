/* Copyright (C) 2023 by WorkerBot.AI */
(function($){function _2(e){var n=$.data(e,"menu").options;$(e).addClass("menu-top"),n.inline?$(e).addClass("menu-inline"):$(e).appendTo("body"),$(e)._bind("_resize",(function(n,t){return($(this).hasClass("easyui-fluid")||t)&&$(e).menu("resize",e),!1}));for(var t=function e(n){var t=[];n.addClass("menu"),t.push(n),n.hasClass("menu-content")||n.children("div").each((function(){var n=$(this).children("div");if(n.length){n.appendTo("body"),this.submenu=n;var i=e(n);t=t.concat(i)}}));return t}($(e)),i=0;i<t.length;i++)_b(e,t[i])}function _b(e,n){var t=$(n).addClass("menu");t.data("menu")||t.data("menu",{options:$.parser.parseOptions(t[0],["width","height"])}),t.hasClass("menu-content")||(t.children("div").each((function(){_f(e,this)})),$('<div class="menu-line"></div>').prependTo(t)),_10(e,t),t.hasClass("menu-inline")||t.hide(),_11(e,t)}function _f(_12,div,_13){var _14=$(div),_15=$.extend({},$.parser.parseOptions(_14[0],["id","name","iconCls","href",{separator:"boolean"}]),{disabled:!!_14.attr("disabled")||void 0,text:$.trim(_14.html()),onclick:_14[0].onclick},_13||{});_15.onclick=_15.onclick||_15.handler||null,_14.data("menuitem",{options:_15}),_15.separator&&_14.addClass("menu-sep"),_14.hasClass("menu-sep")||(_14.addClass("menu-item"),_14.empty().append($('<div class="menu-text"></div>').html(_15.text)),_15.iconCls&&$('<div class="menu-icon"></div>').addClass(_15.iconCls).appendTo(_14),_15.id&&_14.attr("id",_15.id),_15.onclick&&("string"==typeof _15.onclick?_14.attr("onclick",_15.onclick):_14[0].onclick=eval(_15.onclick)),_15.disabled&&_16(_12,_14[0],!0),_14[0].submenu&&$('<div class="menu-rightarrow"></div>').appendTo(_14))}function _10(e,n){var t=$.data(e,"menu").options,i=n.attr("style")||"",o=n.is(":visible");n.css({display:"block",left:-1e4,height:"auto",overflow:"hidden"}),n.find(".menu-item").each((function(){$(this)._outerHeight(t.itemHeight),$(this).find(".menu-text").css({height:t.itemHeight-2+"px",lineHeight:t.itemHeight-2+"px"})})),n.removeClass("menu-noline").addClass(t.noline?"menu-noline":"");var u=n.data("menu").options,a=u.width,s=u.height;isNaN(parseInt(a))&&(a=0,n.find("div.menu-text").each((function(){a<$(this).outerWidth()&&(a=$(this).outerWidth())})),a=a?a+40:"");var r=Math.round(n.outerHeight());if(isNaN(parseInt(s)))if(s=r,n.hasClass("menu-top")&&t.alignTo){var d=$(t.alignTo),c=d.offset().top-$(document).scrollTop(),h=$(window)._outerHeight()+$(document).scrollTop()-d.offset().top-d._outerHeight();s=Math.min(s,Math.max(c,h))}else s>$(window)._outerHeight()&&(s=$(window).height());n.attr("style",i),n.show(),n._size($.extend({},u,{width:a,height:s,minWidth:u.minWidth||t.minWidth,maxWidth:u.maxWidth||t.maxWidth})),n.find(".easyui-fluid").triggerHandler("_resize",[!0]),n.css("overflow",n.outerHeight()<r?"auto":"hidden"),n.children("div.menu-line")._outerHeight(r-2),o||n.hide()}function _11(e,n){var t=$.data(e,"menu").options;for(var i in n._unbind(".menu"),t.events)n._bind(i+".menu",{target:e},t.events[i])}function _25(e){var n=e.data.target,t=$.data(n,"menu");t.timer&&(clearTimeout(t.timer),t.timer=null)}function _28(e){var n=e.data.target,t=$.data(n,"menu");t.options.hideOnUnhover&&(t.timer=setTimeout((function(){_2b(n,$(n).hasClass("menu-inline"))}),t.options.duration))}function _2c(e){var n=e.data.target,t=$(e.target).closest(".menu-item");if(t.length){if(t.siblings().each((function(){this.submenu&&_1(this.submenu),$(this).removeClass("menu-active")})),t.addClass("menu-active"),t.hasClass("menu-item-disabled"))return void t.addClass("menu-active-disabled");var i=t[0].submenu;i&&$(n).menu("show",{menu:i,parent:t})}}function _30(e){var n=$(e.target).closest(".menu-item");if(n.length){n.removeClass("menu-active menu-active-disabled");var t=n[0].submenu;t?e.pageX>=parseInt(t.css("left"))?n.addClass("menu-active"):_1(t):n.removeClass("menu-active")}}function _33(e){var n=e.data.target,t=$(e.target).closest(".menu-item");if(t.length){var i=$(n).data("menu").options,o=t.data("menuitem").options;if(o.disabled)return;t[0].submenu||(_2b(n,i.inline),o.href&&(location.href=o.href)),t.trigger("mouseenter"),i.onClick.call(n,$(n).menu("getItem",t[0]))}}function _2b(e,n){var t=$.data(e,"menu");return t&&$(e).is(":visible")&&(_1($(e)),n?$(e).show():t.options.onHide.call(e)),!1}function _3b(e,n){var t,i;n=n||{};var o=$.data(e,"menu").options,u=$(n.menu||e);if($(e).menu("resize",u[0]),u.hasClass("menu-top")){if($.extend(o,n),t=o.left,i=o.top,o.alignTo){var a=$(o.alignTo);t=a.offset().left,i=a.offset().top+a._outerHeight(),"right"==o.align&&(t+=a.outerWidth()-u.outerWidth())}t+u.outerWidth()>$(window)._outerWidth()+$(document)._scrollLeft()&&(t=$(window)._outerWidth()+$(document).scrollLeft()-u.outerWidth()-5),t<0&&(t=0),i=r(i,o.alignTo)}else{var s=n.parent;(t=s.offset().left+s.outerWidth()-2)+u.outerWidth()+5>$(window)._outerWidth()+$(document).scrollLeft()&&(t=s.offset().left-u.outerWidth()+2),i=r(s.offset().top-3)}function r(e,n){return e+u.outerHeight()>$(window)._outerHeight()+$(document).scrollTop()&&(e=n?$(n).offset().top-u._outerHeight():$(window)._outerHeight()+$(document).scrollTop()-u.outerHeight()),e<0&&(e=0),e}u.css(o.position.call(e,u[0],t,i)),u.show(0,(function(){u[0].shadow||(u[0].shadow=$('<div class="menu-shadow"></div>').insertAfter(u)),u[0].shadow.css({display:u.hasClass("menu-inline")?"none":"block",zIndex:$.fn.menu.defaults.zIndex++,left:u.css("left"),top:u.css("top"),width:u.outerWidth(),height:u.outerHeight()}),u.css("z-index",$.fn.menu.defaults.zIndex++),u.hasClass("menu-top")&&o.onShow.call(e)}))}function _1(e){e&&e.length&&(!function(e){e.stop(!0,!0),e[0].shadow&&e[0].shadow.hide();e.hide()}(e),e.find("div.menu-item").each((function(){this.submenu&&_1(this.submenu),$(this).removeClass("menu-active")})))}function _46(e,n){var t=$.isFunction(n)?n:function(e){for(var t in n)if(e[t]!=n[t])return!1;return!0},i=[];return _4c(e,(function(n){1==t.call(e,n)&&i.push(n)})),i}function _4c(e,n){var t=!1;!function i(o){o.children("div.menu-item").each((function(){if(!t){var o=$(e).menu("getItem",this);0==n.call(e,o)&&(t=!0),this.submenu&&!t&&i(this.submenu)}}))}($(e))}function _16(e,n,t){var i=$(n);if(i.hasClass("menu-item")){var o=i.data("menuitem").options;o.disabled=t,t?(i.addClass("menu-item-disabled"),i[0].onclick=null):(i.removeClass("menu-item-disabled"),i[0].onclick=o.onclick)}}function _55(e,n,t){for(var i=0;i<n.length;i++){var o=$.extend({},n[i],{parent:t});o.children&&o.children.length?(o.id=o.id||"menu_id_"+$.fn.menu.defaults.zIndex++,_5a(e,o),_55(e,o.children,$("#"+o.id)[0])):_5a(e,o)}}function _5a(e,n){$.data(e,"menu").options;var t=$(e);if(n.parent){if(!n.parent.submenu){var i=$("<div></div>").appendTo("body");n.parent.submenu=i,$('<div class="menu-rightarrow"></div>').appendTo(n.parent),_b(e,i)}t=n.parent.submenu}_f(e,$("<div></div>").appendTo(t),n)}function _60(e,n){!function e(n){if(n.submenu){n.submenu.children("div.menu-item").each((function(){e(this)}));var t=n.submenu[0].shadow;t&&t.remove(),n.submenu.remove()}$(n).remove()}(n)}function _65(e,n,t){var i=$(n).parent();t?$(n).show():$(n).hide(),_10(e,i)}function _6a(e){$(e).children("div.menu-item").each((function(){_60(e,this)})),e.shadow&&e.shadow.remove(),$(e).remove()}$((function(){$(document)._unbind(".menu")._bind("mousedown.menu",(function(e){$(e.target).closest("div.menu,div.combo-p").length||($("body>div.menu-top:visible").not(".menu-inline").menu("hide"),_1($("body>div.menu:visible").not(".menu-inline")))}))})),$.fn.menu=function(e,n){return"string"==typeof e?$.fn.menu.methods[e](this,n):(e=e||{},this.each((function(){var n=$.data(this,"menu");n?$.extend(n.options,e):(n=$.data(this,"menu",{options:$.extend({},$.fn.menu.defaults,$.fn.menu.parseOptions(this),e)}),_2(this)),$(this).css({left:n.options.left,top:n.options.top})})))},$.fn.menu.methods={options:function(e){return $.data(e[0],"menu").options},show:function(e,n){return e.each((function(){_3b(this,n)}))},hide:function(e){return e.each((function(){_2b(this)}))},clear:function(e){return e.each((function(){var e=this;$(e).children(".menu-item,.menu-sep").each((function(){_60(e,this)}))}))},destroy:function(e){return e.each((function(){_6a(this)}))},setText:function(e,n){return e.each((function(){$(n.target).data("menuitem").options.text=n.text,$(n.target).children("div.menu-text").html(n.text)}))},setIcon:function(e,n){return e.each((function(){$(n.target).data("menuitem").options.iconCls=n.iconCls,$(n.target).children("div.menu-icon").remove(),n.iconCls&&$('<div class="menu-icon"></div>').addClass(n.iconCls).appendTo(n.target)}))},getItem:function(e,n){var t=$(n).data("menuitem").options;return $.extend({},t,{target:$(n)[0]})},findItem:function(e,n){var t=e.menu("findItems",n);return t.length?t[0]:null},findItems:function(e,n){return _46(e[0],"string"==typeof n?function(e){return $("<div>"+e.text+"</div>").text()==n}:n)},navItems:function(e,n){return e.each((function(){_4c(this,n)}))},appendItems:function(e,n){return e.each((function(){_55(this,n)}))},appendItem:function(e,n){return e.each((function(){_5a(this,n)}))},removeItem:function(e,n){return e.each((function(){_60(this,n)}))},enableItem:function(e,n){return e.each((function(){_16(this,n,!1)}))},disableItem:function(e,n){return e.each((function(){_16(this,n,!0)}))},showItem:function(e,n){return e.each((function(){_65(this,n,!0)}))},hideItem:function(e,n){return e.each((function(){_65(this,n,!1)}))},resize:function(e,n){return e.each((function(){_10(this,$(n||this))}))}},$.fn.menu.parseOptions=function(e){return $.extend({},$.parser.parseOptions(e,[{minWidth:"number",itemHeight:"number",duration:"number",hideOnUnhover:"boolean"},{fit:"boolean",inline:"boolean",noline:"boolean"}]))},$.fn.menu.defaults={zIndex:11e4,left:0,top:0,alignTo:null,align:"left",minWidth:150,itemHeight:32,duration:100,hideOnUnhover:!0,inline:!1,fit:!1,noline:!1,events:{mouseenter:_25,mouseleave:_28,mouseover:_2c,mouseout:_30,click:_33},position:function(e,n,t){return{left:n,top:t}},onShow:function(){},onHide:function(){},onClick:function(e){}}})(jQuery);