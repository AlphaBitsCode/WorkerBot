/* Copyright (C) 2023 by WorkerBot.AI */
!function(e){function t(t,o,s){var a=e(t).data("passwordbox"),n=e(t),r=n.passwordbox("options");if(r.revealed)n.textbox("setValue",o);else{a.converting=!0;for(var i=unescape(r.passwordChar),d=o.split(""),l=n.passwordbox("getValue").split(""),p=0;p<d.length;p++){var x=d[p];x!=l[p]&&x!=i&&l.splice(p,0,x)}var u=n.passwordbox("getSelectionStart");d.length<l.length&&l.splice(u,l.length-d.length,"");for(p=0;p<d.length;p++)(s||p!=u-1)&&(d[p]=i);n.textbox("setValue",l.join("")),n.textbox("setText",d.join("")),n.textbox("setSelectionRange",{start:u,end:u}),setTimeout((function(){a.converting=!1}),0)}}function o(t,o){var s=e(t),a=s.passwordbox("options"),n=s.next().find(".passwordbox-open"),r=unescape(a.passwordChar);o=null==o?s.textbox("getValue"):o,s.textbox("setValue",o),s.textbox("setText",a.revealed?o:o.replace(/./gi,r)),a.revealed?n.addClass("passwordbox-close"):n.removeClass("passwordbox-close")}e.fn.passwordbox=function(t,s){if("string"==typeof t){var a=e.fn.passwordbox.methods[t];return a?a(this,s):this.textbox(t,s)}return t=t||{},this.each((function(){var s,a,n,r=e.data(this,"passwordbox");r?e.extend(r.options,t):r=e.data(this,"passwordbox",{options:e.extend({},e.fn.passwordbox.defaults,e.fn.passwordbox.parseOptions(this),t)}),s=this,a=e.data(s,"passwordbox").options,n=e.extend(!0,[],a.icons),a.showEye&&n.push({iconCls:"passwordbox-open",handler:function(e){a.revealed=!a.revealed,o(s)}}),e(s).addClass("passwordbox-f").textbox(e.extend({},a,{icons:n})),o(s)}))},e.fn.passwordbox.methods={options:function(t){return e.data(t[0],"passwordbox").options},setValue:function(e,t){return e.each((function(){o(this,t)}))},clear:function(e){return e.each((function(){o(this,"")}))},reset:function(t){return t.each((function(){e(this).textbox("reset"),o(this)}))},showPassword:function(t){return t.each((function(){e(this).passwordbox("options").revealed=!0,o(this)}))},hidePassword:function(t){return t.each((function(){e(this).passwordbox("options").revealed=!1,o(this)}))}},e.fn.passwordbox.parseOptions=function(t){return e.extend({},e.fn.textbox.parseOptions(t),e.parser.parseOptions(t,["passwordChar",{checkInterval:"number",lastDelay:"number",revealed:"boolean",showEye:"boolean"}]))},e.fn.passwordbox.defaults=e.extend({},e.fn.textbox.defaults,{passwordChar:"%u25CF",checkInterval:200,lastDelay:500,revealed:!1,showEye:!0,inputEvents:{focus:function(o){var s=o.data.target,a=e(o.data.target),n=a.data("passwordbox"),r=a.data("passwordbox").options;n.checking=!0,n.value=a.passwordbox("getText"),function e(){if(n.checking){var o=a.passwordbox("getText");n.value!=o&&(n.value=o,n.lastTimer&&(clearTimeout(n.lastTimer),n.lastTimer=void 0),t(s,o),n.lastTimer=setTimeout((function(){t(s,a.passwordbox("getText"),!0),n.lastTimer=void 0}),r.lastDelay)),setTimeout(e,r.checkInterval)}}()},blur:function(t){var s=t.data.target,a=e(s).data("passwordbox");a.checking=!1,a.lastTimer&&(clearTimeout(a.lastTimer),a.lastTimer=void 0),o(s)},keydown:function(t){return!e(t.data.target).data("passwordbox").converting}},val:function(t){return e(t).parent().prev().passwordbox("getValue")}})}(jQuery);