/* Copyright (C) 2023 by WorkerBot.AI */
!function(n){function t(t){var e=n.data(t,"menubutton").options,o=n(t),u=o.find("."+e.cls.trigger);u.length||(u=o),u._unbind(".menubutton");var i=null;u._bind(e.showEvent+".menubutton",(function(){if(!n(t).linkbutton("options").disabled)return i=setTimeout((function(){!function(t){var e=n(t).menubutton("options");if(e.disabled||!e.menu)return;n("body>div.menu-top").menu("hide");var o=n(t),u=n(e.menu);u.length&&(u.menu("options").alignTo=o,u.menu("show",{alignTo:o,align:e.menuAlign}));o.blur()}(t)}),e.duration),!1}))._bind(e.hideEvent+".menubutton",(function(){i&&clearTimeout(i),n(e.menu).triggerHandler("mouseleave")}))}n.fn.menubutton=function(e,o){if("string"==typeof e){var u=n.fn.menubutton.methods[e];return u?u(this,o):this.linkbutton(e,o)}return e=e||{},this.each((function(){var o=n.data(this,"menubutton");o?n.extend(o.options,e):(n.data(this,"menubutton",{options:n.extend({},n.fn.menubutton.defaults,n.fn.menubutton.parseOptions(this),e)}),n(this)._propAttr("disabled",!1)),function(t){var e=n.data(t,"menubutton").options,o=n(t);if(o.linkbutton(e),e.hasDownArrow){o.removeClass(e.cls.btn1+" "+e.cls.btn2).addClass("m-btn"),o.removeClass("m-btn-small m-btn-medium m-btn-large").addClass("m-btn-"+e.size);var u=o.find(".l-btn-left");n("<span></span>").addClass(e.cls.arrow).appendTo(u),n("<span></span>").addClass("m-btn-line").appendTo(u)}if(n(t).menubutton("resize"),e.menu){if("string"==typeof e.menu)n(e.menu).menu({duration:e.duration});else if(!(e.menu instanceof jQuery)){var i=e.menu;e.menu=n("<div></div>").appendTo("body").menu({duration:e.duration}),e.menu.menu("appendItems",i)}var s=n(e.menu).menu("options"),a=s.onShow,r=s.onHide;n.extend(s,{onShow:function(){var t=n(this).menu("options"),e=n(t.alignTo),o=e.menubutton("options");e.addClass(1==o.plain?o.cls.btn2:o.cls.btn1),a.call(this)},onHide:function(){var t=n(this).menu("options"),e=n(t.alignTo),o=e.menubutton("options");e.removeClass(1==o.plain?o.cls.btn2:o.cls.btn1),r.call(this)}})}}(this),t(this)}))},n.fn.menubutton.methods={options:function(t){var e=t.linkbutton("options");return n.extend(n.data(t[0],"menubutton").options,{toggle:e.toggle,selected:e.selected,disabled:e.disabled})},destroy:function(t){return t.each((function(){var t=n(this).menubutton("options");t.menu&&n(t.menu).menu("destroy"),n(this).remove()}))}},n.fn.menubutton.parseOptions=function(t){n(t);return n.extend({},n.fn.linkbutton.parseOptions(t),n.parser.parseOptions(t,["menu",{plain:"boolean",hasDownArrow:"boolean",duration:"number"}]))},n.fn.menubutton.defaults=n.extend({},n.fn.linkbutton.defaults,{plain:!0,hasDownArrow:!0,menu:null,menuAlign:"left",duration:100,showEvent:"mouseenter",hideEvent:"mouseleave",cls:{btn1:"m-btn-active",btn2:"m-btn-plain-active",arrow:"m-btn-downarrow",trigger:"m-btn"}})}(jQuery);