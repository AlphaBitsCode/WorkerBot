/* Copyright (C) 2023 by WorkerBot.AI */
!function(e){function t(t,s){for(var a=e(t).maskedbox("options"),n=(s||e(t).maskedbox("getText")||"").split(""),o=[],i=0;i<a.mask.length;i++)if(a.masks[a.mask[i]]){var r=n[i];o.push(r!=a.promptChar?r:" ")}return o.join("")}function s(t,s){for(var a=e(t).maskedbox("options"),n=s.split(""),o=[],i=0;i<a.mask.length;i++){var r=a.mask[i],d=a.masks[r];if(d){var k=n.shift();if(null!=k)if(new RegExp(d,"i").test(k)){o.push(k);continue}o.push(a.promptChar)}else o.push(r)}return o.join("")}function a(a,r){e(a).maskedbox("options");var d=t(a).split(""),k=e(a).maskedbox("getSelectionRange");if(k.start==k.end){if(r)var m=i(a,k.start);else m=o(a,k.start);(x=m-n(a,m))>=0&&d.splice(x,1)}else{m=o(a,k.start);var u=i(a,k.end),x=m-n(a,m),f=u-n(a,u);d.splice(x,f-x+1)}e(a).maskedbox("setValue",s(a,d.join(""))),e(a).maskedbox("setSelectionRange",{start:m,end:m})}function n(t,s){var a=e(t).maskedbox("options"),n=0;s>=a.mask.length&&s--;for(var o=s;o>=0;o--)null==a.masks[a.mask[o]]&&n++;return n}function o(t,s){for(var a=e(t).maskedbox("options"),n=a.mask[s],o=a.masks[n];s<a.mask.length&&!o;)s++,n=a.mask[s],o=a.masks[n];return s}function i(t,s){for(var a=e(t).maskedbox("options"),n=a.mask[--s],o=a.masks[n];s>=0&&!o;)s--,n=a.mask[s],o=a.masks[n];return s<0?0:s}e.extend(e.fn.textbox.methods,{inputMask:function(t,s){return t.each((function(){var t=this,a=e.extend({},e.fn.maskedbox.defaults,s);e.data(t,"maskedbox",{options:a});var n=e(t).textbox("textbox");for(var o in n._unbind(".maskedbox"),a.inputEvents)n._bind(o+".maskedbox",{target:t},a.inputEvents[o])}))}}),e.fn.maskedbox=function(t,s){if("string"==typeof t){var a=e.fn.maskedbox.methods[t];return a?a(this,s):this.textbox(t,s)}return t=t||{},this.each((function(){var s,a,n=e.data(this,"maskedbox");n?e.extend(n.options,t):e.data(this,"maskedbox",{options:e.extend({},e.fn.maskedbox.defaults,e.fn.maskedbox.parseOptions(this),t)}),a=e(s=this).data("maskedbox").options,e(s).textbox(a),e(s).maskedbox("initValue",a.value)}))},e.fn.maskedbox.methods={options:function(t){var s=t.textbox("options");return e.extend(e.data(t[0],"maskedbox").options,{width:s.width,value:s.value,originalValue:s.originalValue,disabled:s.disabled,readonly:s.readonly})},initValue:function(a,n){return a.each((function(){n=s(this,t(this,n)),e(this).textbox("initValue",n)}))},setValue:function(a,n){return a.each((function(){n=s(this,t(this,n)),e(this).textbox("setValue",n)}))}},e.fn.maskedbox.parseOptions=function(t){e(t);return e.extend({},e.fn.textbox.parseOptions(t),e.parser.parseOptions(t,["mask","promptChar"]),{})},e.fn.maskedbox.defaults=e.extend({},e.fn.textbox.defaults,{mask:"",promptChar:"_",masks:{9:"[0-9]",a:"[a-zA-Z]","*":"[0-9a-zA-Z]"},inputEvents:{keydown:function(i){if(!i.metaKey&&!i.ctrlKey){var r=i.data.target;e(r).maskedbox("options");if(-1!=e.inArray(i.keyCode,[9,13,35,36,37,39]))return!0;i.keyCode>=96&&i.keyCode<=105&&(i.keyCode-=48);var d=String.fromCharCode(i.keyCode);return i.keyCode>=65&&i.keyCode<=90&&!i.shiftKey?d=d.toLowerCase():189==i.keyCode?d="-":187==i.keyCode?d="+":190==i.keyCode&&(d="."),8==i.keyCode?a(r,!0):46==i.keyCode?a(r,!1):function(a,i){var r=e(a).maskedbox("options"),d=e(a).maskedbox("getSelectionRange"),k=o(a,d.start),m=o(a,d.end);if(-1!=k&&new RegExp(r.masks[r.mask[k]],"i").test(i)){var u=t(a).split(""),x=k-n(a,k),f=m-n(a,m);u.splice(x,f-x,i),e(a).maskedbox("setValue",s(a,u.join(""))),k=o(a,++k),e(a).maskedbox("setSelectionRange",{start:k,end:k})}}(r,d),!1}}}})}(jQuery);