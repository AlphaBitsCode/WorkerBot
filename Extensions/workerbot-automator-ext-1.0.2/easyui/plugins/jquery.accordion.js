/* Copyright (C) 2023 by WorkerBot.AI */
!function(e){function n(n,a){var o=e.data(n,"accordion"),t=o.options,i=o.panels,l=e(n),r="left"==t.halign||"right"==t.halign;l.children(".panel-last").removeClass("panel-last"),l.children(".panel:last").addClass("panel-last"),a&&e.extend(t,{width:a.width,height:a.height}),l._size(t);var c=0,d="auto",s=l.find(">.panel>.accordion-header");function h(e,n){for(var a=0,o=0;o<i.length;o++){var t=i[o];if(r)var d=t.panel("header")._outerWidth(c);else d=t.panel("header")._outerHeight(c);if(t.panel("options").collapsible==e){var s=isNaN(n)?void 0:n+c*d.length;r?(t.panel("resize",{height:l.height(),width:e?s:void 0}),a+=t.panel("panel")._outerWidth()-c*d.length):(t.panel("resize",{width:l.width(),height:e?s:void 0}),a+=t.panel("panel").outerHeight()-c*d.length)}}return a}s.length&&(r?(e(s[0]).next().panel("resize",{width:l.width(),height:l.height()}),c=e(s[0])._outerWidth()):c=e(s[0]).css("height","")._outerHeight()),isNaN(parseInt(t.height))||(d=r?l.width()-c*s.length:l.height()-c*s.length),h(!0,d-h(!1))}function a(n,a,o,t){for(var i=e.data(n,"accordion").panels,l=[],r=0;r<i.length;r++){var c=i[r];if(a)c.panel("options")[a]==o&&l.push(c);else if(c[0]==e(o)[0])return r}return a?t?l:l.length?l[0]:null:-1}function o(e){return a(e,"collapsed",!1,!0)}function t(e){var n=o(e);return n.length?n[0]:null}function i(e,n){return a(e,null,n)}function l(n,o){var t=e.data(n,"accordion").panels;return"number"==typeof o?o<0||o>=t.length?null:t[o]:a(n,"title",o)}function r(n,a,t){var l=e.data(n,"accordion").options;a.panel(e.extend({},{collapsible:!0,minimizable:!1,maximizable:!1,closable:!1,doSize:!1,collapsed:!0,headerCls:"accordion-header",bodyCls:"accordion-body",halign:l.halign},t,{onBeforeExpand:function(){if(t.onBeforeExpand&&0==t.onBeforeExpand.call(this))return!1;if(!l.multiple)for(var a=e.grep(o(n),(function(e){return e.panel("options").collapsible})),r=0;r<a.length;r++)d(n,i(n,a[r]));var c=e(this).panel("header");c.addClass("accordion-header-selected"),c.find(".accordion-collapse").removeClass("accordion-expand")},onExpand:function(){e(n).find(">.panel-last>.accordion-header").removeClass("accordion-header-border"),t.onExpand&&t.onExpand.call(this),l.onSelect.call(n,e(this).panel("options").title,i(n,this))},onBeforeCollapse:function(){if(t.onBeforeCollapse&&0==t.onBeforeCollapse.call(this))return!1;e(n).find(">.panel-last>.accordion-header").addClass("accordion-header-border");var a=e(this).panel("header");a.removeClass("accordion-header-selected"),a.find(".accordion-collapse").addClass("accordion-expand")},onCollapse:function(){isNaN(parseInt(l.height))&&e(n).find(">.panel-last>.accordion-header").removeClass("accordion-header-border"),t.onCollapse&&t.onCollapse.call(this),l.onUnselect.call(n,e(this).panel("options").title,i(n,this))}}));var r=a.panel("header"),s=r.children("div.panel-tool");s.children("a.panel-tool-collapse").hide();var h=e('<a href="javascript:;"></a>').addClass("accordion-collapse accordion-expand").appendTo(s);function p(e){var a=e.panel("options");if(a.collapsible){var o=i(n,e);a.collapsed?c(n,o):d(n,o)}}h._bind("click",(function(){return p(a),!1})),a.panel("options").collapsible?h.show():h.hide(),"left"!=l.halign&&"right"!=l.halign||h.hide(),r._bind("click",(function(){return p(a),!1}))}function c(n,a){var o=l(n,a);if(o){s(n);var t=e.data(n,"accordion").options;o.panel("expand",t.animate)}}function d(n,a){var o=l(n,a);if(o){s(n);var t=e.data(n,"accordion").options;o.panel("collapse",t.animate)}}function s(n){for(var a=e.data(n,"accordion").panels,o=0;o<a.length;o++)a[o].stop(!0,!0)}e.fn.accordion=function(o,t){return"string"==typeof o?e.fn.accordion.methods[o](this,t):(o=o||{},this.each((function(){var t,l,d,s=e.data(this,"accordion");s?e.extend(s.options,o):(e.data(this,"accordion",{options:e.extend({},e.fn.accordion.defaults,e.fn.accordion.parseOptions(this),o),accordion:e(this).addClass("accordion"),panels:[]}),t=this,l=e.data(t,"accordion"),(d=e(t)).addClass("accordion"),l.panels=[],d.children("div").each((function(){var n=e.extend({},e.parser.parseOptions(this),{selected:!!e(this).attr("selected")||void 0}),a=e(this);l.panels.push(a),r(t,a,n)})),d._bind("_resize",(function(a,o){return(e(this).hasClass("easyui-fluid")||o)&&n(t),!1}))),function(n){var a=e.data(n,"accordion").options,o=e(n);a.border?o.removeClass("accordion-noborder"):o.addClass("accordion-noborder")}(this),n(this),function(n){var o=e.data(n,"accordion").options;e(n).find(">.panel-last>.accordion-header").addClass("accordion-header-border");var t=a(n,"selected",!0);function l(e){var a=o.animate;o.animate=!1,c(n,e),o.animate=a}l(t?i(n,t):o.selected)}(this)})))},e.fn.accordion.methods={options:function(n){return e.data(n[0],"accordion").options},panels:function(n){return e.data(n[0],"accordion").panels},resize:function(e,a){return e.each((function(){n(this,a)}))},getSelections:function(e){return o(e[0])},getSelected:function(e){return t(e[0])},getPanel:function(e,n){return l(e[0],n)},getPanelIndex:function(e,n){return i(e[0],n)},select:function(e,n){return e.each((function(){c(this,n)}))},unselect:function(e,n){return e.each((function(){d(this,n)}))},add:function(a,o){return a.each((function(){!function(a,o){var t=e.data(a,"accordion"),i=t.options,l=t.panels;null==o.selected&&(o.selected=!0),s(a);var d=e("<div></div>").appendTo(a);l.push(d),r(a,d,o),n(a),i.onAdd.call(a,o.title,l.length-1),o.selected&&c(a,l.length-1)}(this,o)}))},remove:function(a,o){return a.each((function(){!function(a,o){var r=e.data(a,"accordion"),d=r.options,h=r.panels;s(a);var p=l(a,o),u=p.panel("options").title,f=i(a,p);p&&0!=d.onBeforeRemove.call(a,u,f)&&(h.splice(f,1),p.panel("destroy"),h.length&&(n(a),t(a)||c(a,0)),d.onRemove.call(a,u,f))}(this,o)}))}},e.fn.accordion.parseOptions=function(n){e(n);return e.extend({},e.parser.parseOptions(n,["width","height","halign",{fit:"boolean",border:"boolean",animate:"boolean",multiple:"boolean",selected:"number"}]))},e.fn.accordion.defaults={width:"auto",height:"auto",fit:!1,border:!0,animate:!0,multiple:!1,selected:0,halign:"top",onSelect:function(e,n){},onUnselect:function(e,n){},onAdd:function(e,n){},onBeforeRemove:function(e,n){},onRemove:function(e,n){}}}(jQuery);